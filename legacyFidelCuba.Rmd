---
title: "Legacy of Fidel Castro"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message=FALSE)
```


```{r}
require(WDI)
require(countrycode)
require(dplyr)
require(googleVis)
op <- options(gvis.plot.tag='chart')
```

There has been lots of dicussion and debate on social and electronic media on the legacy of Fidel Castro. Particularly discussion was on Cuba's exemplary achievement in health sector. I thought it would be a good opportunity to dig into data and trace Fidel's legacy. 

This World Bank published WDI indicators data available from 1960, right about the time Fidel got into power ousting Batista government. Therefore, this particular data set synchronizes pretty well with Castro's long run in the stint. 

First, we look into life expectancy data. When we plot life expectancy agains mortality rate, we find that Cuba has the lowest mortality rate (47) compared to other Latin American and Carribean countries. In terms of life expectancy, only Uruguay (68.4)  is higher than Cuba (65.8). 

```{r}
latin %>%
  filter(year==1960) %>%
  select(country,life_expectancy) %>%
  arrange(desc(life_expectancy)) %>%
  slice(1:10)
```

Now how about now?

```{r}
latin %>%
  filter(year==2014) %>%
  select(country,life_expectancy) %>%
  arrange(desc(life_expectancy)) %>%
  slice(1:10)
```

Now let's find the rank of cuba throughtout the time span

```{r}
le_rank <- latin %>%
  select(country,year,life_expectancy) %>%
  group_by(year) %>%
  mutate(rank=min_rank(desc(life_expectancy))) %>%
  filter(country=="Cuba")

ggplot(le_rank,aes(x=year,y=rank)) + geom_bar(stat = "identity")
```


Therefore, we can say that the country which Castro received from his predecessor was in pretty good shape in terms health sector. What was impressive about Castro's regime was that he was able to maintain this robust situation in health sector and as a result Cuba is still leading the region in healths sector s  . Therefore good health sector was not Cu  Castro's legacy it was rather Cuba's legacy. 

In the following, figure on the bottom right in Trails panel, select Cuba so that Cuba's run in the last 55 years is explicityly traced.


```{r,results='asis',tidy=FALSE}
load("./RDATA/latin.RData")
LE_MR<- gvisMotionChart(latin,
                      idvar="country", timevar="year",
                      xvar="life_expectancy",yvar="Mortality_Rate",
                      colorvar="iso2c", sizevar="population",
                      options=list(width=640,
                                   #state=myState,
                                   height=420))
## Display the chart in the browser
plot(LE_MR)
```


This fact that Cuba has been one of the top countries throughout its last 50 years or so history in health can be better explained in the following diagrams where we look upon those two indicators individually.



```{r,results='asis',tidy=FALSE}
LE<- gvisMotionChart(latin,
                      idvar="country", timevar="year",
                      xvar="index",yvar="Mortality_Rate",
                      colorvar="iso2c", sizevar="population",
                      options=list(width=640,
                                   #state=myState,
                                   height=420))
## Display the chart in the browser
plot(LE)
```

In the above, we find that in terms of life expectancy Cuba was one of the top countries and stayed as one of the top countries. 




```{r,results='asis',tidy=FALSE}
MR<- gvisMotionChart(latin,
                      idvar="country", timevar="year",
                      xvar="index",yvar="Mortality_Rate",
                      colorvar="iso2c", sizevar="population",
                      options=list(width=640,
                                   #state=myState,
                                   height=420))
## Display the chart in the browser
plot(MR)
```


Another argument that has been regularly put forward is that Castro has made Cuba impoverished. Let's put this into our data grinding machine and check what comes out. 

```{r,results='asis',tidy=FALSE}
pcgdp<- gvisMotionChart(latin,
                      idvar="country", timevar="year",
                      yvar="GDP_per_capita_Constant_USD", xvar="population",
                      colorvar="iso2c", sizevar="population",
                      options=list(width=640,
                                   #state=myState,
                                   height=420))
## Display the chart in the browser
plot(pcgdp)
```


